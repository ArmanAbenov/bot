# üéØ –°–∏—Å—Ç–µ–º–∞ —Ä–æ–ª–µ–π –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –æ—Ç–¥–µ–ª–∞–º–∏

## –û–±–∑–æ—Ä

–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø—Ä–∞–≤–∞–º–∏ –¥–æ—Å—Ç—É–ø–∞ –∏ –æ—Ç–¥–µ–ª–∞–º–∏ –¥–ª—è UQ-bot:
- **Auto-Registration**: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –ø—Ä–∏ `/start`
- **Department-based RAG**: –ü–æ–∏—Å–∫ –∑–Ω–∞–Ω–∏–π —Å —É—á–µ—Ç–æ–º –æ—Ç–¥–µ–ª–∞ + –æ–±—â–∏–µ –∑–Ω–∞–Ω–∏—è
- **Admin Panel**: –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞–º–∏ –∏ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ –æ—Ç–¥–µ–ª–æ–≤
- **User Notifications**: –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –ø—Ä–∏ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏–∏ –æ—Ç–¥–µ–ª–∞

---

## 1. Auto-Registration (–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è)

### –õ–æ–≥–∏–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

–ü—Ä–∏ –∫–æ–º–∞–Ω–¥–µ `/start`:
- –ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å **–ù–ï –≤ —Å–ø–∏—Å–∫–µ ADMIN_IDS** ‚Üí —Å–æ–∑–¥–∞–µ—Ç—Å—è —Å `department="common"` (–æ–±—â–∏–π –¥–æ—Å—Ç—É–ø)
- –ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å **–≤ —Å–ø–∏—Å–∫–µ ADMIN_IDS** ‚Üí —Å–æ–∑–¥–∞–µ—Ç—Å—è —Å `department=None` (God Mode)

```python
# app/bot/handlers/start.py - cmd_start()
user = User(
    telegram_id=telegram_id,
    full_name=full_name,
    role="admin" if user_is_admin else "employee",
    department=None if user_is_admin else "common",  # –ö–ª—é—á–µ–≤–∞—è –ª–æ–≥–∏–∫–∞
    language=None,  # –ë—É–¥–µ—Ç –≤—ã–±—Ä–∞–Ω –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º
)
```

### –°—Ç–∞—Ç—É—Å –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –¥–ª—è –Ω–æ–≤—ã—Ö —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤:
- **Role**: `"employee"`
- **Department**: `"common"` (–¥–æ—Å—Ç—É–ø —Ç–æ–ª—å–∫–æ –∫ –æ–±—â–∏–º –∑–Ω–∞–Ω–∏—è–º)
- **Language**: `None` (–≤—ã–±–∏—Ä–∞–µ—Ç—Å—è –Ω–∞ —Å–ª–µ–¥—É—é—â–µ–º —à–∞–≥–µ)

---

## 2. Enum Department (–û—Ç–¥–µ–ª—ã)

### –û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–π —Å–ø–∏—Å–æ–∫ –æ—Ç–¥–µ–ª–æ–≤:

```python
# app/core/models.py
class Department(str, Enum):
    COMMON = "common"                      # –û–±—â–∏–π –¥–æ—Å—Ç—É–ø (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
    SORTING = "sorting"                    # –°–æ—Ä—Ç–∏—Ä–æ–≤–æ—á–Ω—ã–π —Ü–µ–Ω—Ç—Ä
    MANAGER = "manager"                    # –ú–µ–Ω–µ–¥–∂–µ—Ä
    COURIER = "delivery/courier"           # –ö—É—Ä—å–µ—Ä
    FRANCHISE = "delivery/franchise"       # –§—Ä–∞–Ω—á–∞–π–∑–∏
    CUSTOMER_SERVICE = "customer_service"  # –ö–ª–∏–µ–Ω—Ç—Å–∫–∏–π —Å–µ—Ä–≤–∏—Å
```

### –ù–æ–≤—ã–µ –º–µ—Ç–æ–¥—ã:

1. **`get_admin_assignable_departments()`** ‚Äî –û—Ç–¥–µ–ª—ã, –∫–æ—Ç–æ—Ä—ã–µ –∞–¥–º–∏–Ω –º–æ–∂–µ—Ç –Ω–∞–∑–Ω–∞—á–∞—Ç—å (–∏—Å–∫–ª—é—á–∞–µ—Ç COMMON)
2. **`get_display_names()`** ‚Äî –ß–µ–ª–æ–≤–µ–∫–æ—á–∏—Ç–∞–µ–º—ã–µ –Ω–∞–∑–≤–∞–Ω–∏—è –æ—Ç–¥–µ–ª–æ–≤ –¥–ª—è UI

---

## 3. RAG Permissions (–°–∏—Å—Ç–µ–º–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ –∑–Ω–∞–Ω–∏—è–º)

### –õ–æ–≥–∏–∫–∞ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏:

| –†–æ–ª—å/–û—Ç–¥–µ–ª | –î–æ—Å—Ç—É–ø –∫ –∑–Ω–∞–Ω–∏—è–º |
|------------|------------------|
| **Admin** (department=None) | **God Mode**: –í—Å–µ –æ—Ç–¥–µ–ª—ã + common (–ø–æ–∏—Å–∫ –ø–æ –≤—Å–µ–º –∏–Ω–¥–µ–∫—Å–∞–º) |
| **Employee** (department="common") | –¢–æ–ª—å–∫–æ common |
| **Employee** (department="sorting") | sorting + common |
| **Employee** (department="manager") | manager + common |

### –†–µ–∞–ª–∏–∑–∞—Ü–∏—è:

```python
# app/services/ai_service.py - get_answer()

# 1. God Mode –¥–ª—è –∞–¥–º–∏–Ω–æ–≤
if user_department is None:
    # –ò—â–µ–º –ø–æ –í–°–ï–ú –∏–Ω–¥–µ–∫—Å–∞–º –æ—Ç–¥–µ–ª–æ–≤
    for dept_name, dept_store in GeminiService._vector_stores.items():
        dept_results = dept_store.search(query_embedding, top_k=2)
        all_search_results.extend(dept_results)

# 2. –û–±—ã—á–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏: —Å–≤–æ–π –æ—Ç–¥–µ–ª + common
elif user_department and user_department in GeminiService._vector_stores:
    # –ü–æ–∏—Å–∫ –≤ —Å–≤–æ–µ–º –æ—Ç–¥–µ–ª–µ (–ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç)
    dept_results = vector_store.search(query_embedding, top_k=2)
    search_results.extend(dept_results)
    
    # –ü–æ–∏—Å–∫ –≤ common (–µ—Å–ª–∏ —ç—Ç–æ –Ω–µ —Å–∞–º common)
    if user_department != "common" and "common" in GeminiService._vector_stores:
        common_results = common_store.search(query_embedding, top_k=2)
        search_results.extend(common_results)
```

### –î–µ–¥—É–ø–ª–∏–∫–∞—Ü–∏—è –¥–ª—è –∞–¥–º–∏–Ω–æ–≤:
- –ï—Å–ª–∏ —Ñ–∞–π–ª –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ `common/`, –ø–æ–º–µ—á–∞–µ—Ç—Å—è –∫–∞–∫ "–û–±—â–∏–µ –∑–Ω–∞–Ω–∏—è"
- –ê–¥–º–∏–Ω –≤–∏–¥–∏—Ç –º–µ—Ç–∫–∏ –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤: `[–ò—Å—Ç–æ—á–Ω–∏–∫: sorting]`, `[–ò—Å—Ç–æ—á–Ω–∏–∫: –û–±—â–∏–µ –∑–Ω–∞–Ω–∏—è]`

---

## 4. Admin Panel (–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞–º–∏)

### 4.1. –ù–æ–≤–∞—è –∫–Ω–æ–ø–∫–∞ –≤ –∞–¥–º–∏–Ω-–º–µ–Ω—é

–î–æ–±–∞–≤–ª–µ–Ω–∞ –∫–Ω–æ–ø–∫–∞ **"üë• –°–æ—Ç—Ä—É–¥–Ω–∏–∫–∏"** –≤ –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é –∞–¥–º–∏–Ω–∫–∏:

```python
# app/bot/handlers/admin.py - get_admin_menu()
keyboard = [
    ["üìù –î–æ–±–∞–≤–∏—Ç—å –∑–Ω–∞–Ω–∏–µ"],
    ["üì• –î–æ–±–∞–≤–∏—Ç—å —Ñ–∞–π–ª"],
    ["üìö –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –±–∞–∑–æ–π –∑–Ω–∞–Ω–∏–π"],
    ["üë• –°–æ—Ç—Ä—É–¥–Ω–∏–∫–∏"],  # –ù–û–í–ê–Ø –ö–ù–û–ü–ö–ê
    ["üë• –ê–¥–º–∏–Ω—ã"],
    ["üîë –ò–Ω–≤–∞–π—Ç-–∫–æ–¥"],
    ["‚óÄÔ∏è –ù–∞–∑–∞–¥ –≤ –º–µ–Ω—é"]
]
```

### 4.2. –°–ø–∏—Å–æ–∫ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤

**–•–µ–Ω–¥–ª–µ—Ä**: `handle_manage_employees`

**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç**:
1. –ü–æ–ª—É—á–∞–µ—Ç –≤—Å–µ—Ö –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —á–µ—Ä–µ–∑ `get_all_employees(session)`
2. –§–æ—Ä–º–∏—Ä—É–µ—Ç Inline-–∫–Ω–æ–ø–∫–∏ —Å –∏–º–µ–Ω–∞–º–∏ –∏ —Ç–µ–∫—É—â–∏–º–∏ –æ—Ç–¥–µ–ª–∞–º–∏
3. Callback: `emp_view:{telegram_id}`

**–ü—Ä–∏–º–µ—Ä –≤—ã–≤–æ–¥–∞**:
```
üë• –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∏:

–í—Å–µ–≥–æ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–æ: 15

[–ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤ (–°–æ—Ä—Ç–∏—Ä–æ–≤–æ—á–Ω—ã–π)]
[–ú–∞—Ä–∏—è –ü–µ—Ç—Ä–æ–≤–∞ (–û–±—â–∏–π –¥–æ—Å—Ç—É–ø)]
[–ê–ª–µ–∫—Å–µ–π –°–∏–¥–æ—Ä–æ–≤ (–ú–µ–Ω–µ–¥–∂–µ—Ä)]
...
```

### 4.3. –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–µ

**Callback**: `emp_view:{telegram_id}`
**–•–µ–Ω–¥–ª–µ—Ä**: `handle_employee_view_callback`

**–ß—Ç–æ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç**:
```
üë§ –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–µ:

–ò–º—è: –ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤
Telegram ID: 123456789
–†–æ–ª—å: –°–æ—Ç—Ä—É–¥–Ω–∏–∫
–û—Ç–¥–µ–ª: –°–æ—Ä—Ç–∏—Ä–æ–≤–æ—á–Ω—ã–π —Ü–µ–Ω—Ç—Ä
–Ø–∑—ã–∫: –†—É—Å—Å–∫–∏–π
–î–∞—Ç–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏: 15.02.2026 14:30

[üîÑ –°–º–µ–Ω–∏—Ç—å –æ—Ç–¥–µ–ª]
[‚¨ÖÔ∏è –ö —Å–ø–∏—Å–∫—É —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤]
```

### 4.4. –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ –æ—Ç–¥–µ–ª–∞

**Callback**: `emp_assign:{telegram_id}`
**–•–µ–Ω–¥–ª–µ—Ä**: `handle_employee_assign_callback`

**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç**:
1. –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å–ø–∏—Å–æ–∫ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –æ—Ç–¥–µ–ª–æ–≤ (–∏–∑ `get_admin_assignable_departments()`)
2. –ê–¥–º–∏–Ω –≤—ã–±–∏—Ä–∞–µ—Ç –æ—Ç–¥–µ–ª –¥–ª—è —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞
3. Callback: `emp_set:{telegram_id}:{department_code}`

**–°–ø–∏—Å–æ–∫ –æ—Ç–¥–µ–ª–æ–≤ –¥–ª—è –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è**:
```
–í—ã–±–µ—Ä–∏—Ç–µ –æ—Ç–¥–µ–ª –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤:

[–°–æ—Ä—Ç–∏—Ä–æ–≤–æ—á–Ω—ã–π —Ü–µ–Ω—Ç—Ä]
[–ú–µ–Ω–µ–¥–∂–µ—Ä]
[–ö—É—Ä—å–µ—Ä]
[–§—Ä–∞–Ω—á–∞–π–∑–∏]
[–ö–ª–∏–µ–Ω—Ç—Å–∫–∏–π —Å–µ—Ä–≤–∏—Å]

[–ù–∞–∑–∞–¥]
```

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ**: –û—Ç–¥–µ–ª `COMMON` –ù–ï –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è (—ç—Ç–æ –¥–µ—Ñ–æ–ª—Ç–Ω—ã–π —Å—Ç–∞—Ç—É—Å, –µ–≥–æ –Ω–µ–ª—å–∑—è –Ω–∞–∑–Ω–∞—á–∏—Ç—å –≤—Ä—É—á–Ω—É—é).

### 4.5. –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è

**Callback**: `emp_set:{telegram_id}:{department_code}`
**–•–µ–Ω–¥–ª–µ—Ä**: `handle_employee_set_department_callback`

**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç**:
1. –í—ã–∑—ã–≤–∞–µ—Ç `assign_department_to_employee(session, telegram_id, department_code)`
2. –û–±–Ω–æ–≤–ª—è–µ—Ç –ø–æ–ª–µ `department` –≤ –ë–î
3. –ü—Ä–æ–≤–µ—Ä—è–µ—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —á–µ—Ä–µ–∑ `session.refresh(user)`
4. **–û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é** (—Å–º. –Ω–∏–∂–µ)
5. –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ

**–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ**:
```
[EMPLOYEES] COMMIT executed for user 123456789
[EMPLOYEES] ‚úÖ Department assigned to 123456789 (–ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤): sorting (was: common)
Notification sent to user 123456789 about department assignment
Admin 987654321 assigned department 'sorting' to employee 123456789
```

---

## 5. User Notifications (–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º)

### –õ–æ–≥–∏–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π:

–ü—Ä–∏ —É—Å–ø–µ—à–Ω–æ–º –Ω–∞–∑–Ω–∞—á–µ–Ω–∏–∏ –æ—Ç–¥–µ–ª–∞ –±–æ—Ç **–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –ª–∏—á–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ** –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é:

```python
# app/bot/handlers/admin.py - handle_employee_set_department_callback
notification_text = (
    f"{i18n.get('employee_notification_title', user_lang)}\n\n"
    f"{i18n.get('employee_notification_assigned', user_lang, department=department_name)}"
)
await bot.send_message(telegram_id, notification_text)
```

### –ü—Ä–∏–º–µ—Ä —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è (ru):
```
üì¢ –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ

–í–∞–º –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω –¥–æ—Å—Ç—É–ø –∫ –æ—Ç–¥–µ–ª—É: –°–æ—Ä—Ç–∏—Ä–æ–≤–æ—á–Ω—ã–π —Ü–µ–Ω—Ç—Ä
```

### –ü—Ä–∏–º–µ—Ä —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è (en):
```
üì¢ Notification

You have been granted access to department: Sorting Center
```

### –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫:
- –ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–ª –±–æ—Ç–∞ ‚Üí —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –Ω–µ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è, –ª–æ–≥–∏—Ä—É–µ—Ç—Å—è –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ
- –û—Ç–¥–µ–ª –≤—Å–µ —Ä–∞–≤–Ω–æ –Ω–∞–∑–Ω–∞—á–∞–µ—Ç—Å—è –≤ –ë–î

---

## 6. –ù–æ–≤—ã–π —Å–µ—Ä–≤–∏—Å: employee_service.py

### –§—É–Ω–∫—Ü–∏–∏:

#### 6.1. `get_all_employees(session: AsyncSession) -> List[User]`
–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –≤—Å–µ—Ö –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –ø–æ –¥–∞—Ç–µ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ (–Ω–æ–≤—ã–µ –ø–µ—Ä–≤—ã–µ).

#### 6.2. `get_employee_by_telegram_id(session: AsyncSession, telegram_id: int) -> User | None`
–ù–∞—Ö–æ–¥–∏—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø–æ Telegram ID.

#### 6.3. `assign_department_to_employee(session: AsyncSession, telegram_id: int, department: str) -> bool`
–ù–∞–∑–Ω–∞—á–∞–µ—Ç –æ—Ç–¥–µ–ª –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é —á–µ—Ä–µ–∑ –ø—Ä—è–º–æ–µ –ø—Ä–∏—Å–≤–∞–∏–≤–∞–Ω–∏–µ (`user.department = department`) –∏ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —á–µ—Ä–µ–∑ `session.refresh(user)`.

#### 6.4. `hash_user_id(telegram_id: int) -> str`
–°–æ–∑–¥–∞–µ—Ç –∫–æ—Ä–æ—Ç–∫–∏–π —Ö–µ—à (8 —Å–∏–º–≤–æ–ª–æ–≤) –¥–ª—è Telegram ID –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≤ callback_data (–∏–∑–±–µ–≥–∞–µ—Ç `BUTTON_DATA_INVALID`).

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ**: –í —Ç–µ–∫—É—â–µ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ —Ö–µ—à —Å–æ–∑–¥–∞–µ—Ç—Å—è, –Ω–æ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è, —Ç.–∫. callback_data –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –ø–æ–ª–Ω—ã–π `telegram_id`. –ü—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –º–æ–∂–Ω–æ –ø–µ—Ä–µ–∫–ª—é—á–∏—Ç—å—Å—è –Ω–∞ —Ö–µ—à-–ø–æ–¥—Ö–æ–¥.

#### 6.5. `format_user_info(user: User, lang: str = "ru") -> str`
–§–æ—Ä–º–∞—Ç–∏—Ä—É–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Å —É—á–µ—Ç–æ–º –ª–æ–∫–∞–ª–∏–∑–∞—Ü–∏–∏.

---

## 7. –õ–æ–∫–∞–ª–∏–∑–∞—Ü–∏—è (i18n)

### –ù–æ–≤—ã–µ –∫–ª—é—á–∏ –≤–æ –≤—Å–µ—Ö —è–∑—ã–∫–∞—Ö (ru, en, kk, zh):

```json
"admin_manage_employees": "üë• –°–æ—Ç—Ä—É–¥–Ω–∏–∫–∏",
"employees_list_header": "üë• –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∏:",
"employees_list_empty": "–ü–æ–∫–∞ –Ω–µ—Ç –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤.",
"employee_info_header": "üë§ –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–µ:",
"employee_info_name": "–ò–º—è: {name}",
"employee_info_id": "Telegram ID: {id}",
"employee_info_role": "–†–æ–ª—å: {role}",
"employee_info_department": "–û—Ç–¥–µ–ª: {department}",
"employee_info_language": "–Ø–∑—ã–∫: {language}",
"employee_info_registered": "–î–∞—Ç–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏: {date}",
"employee_assign_department": "üìã –ù–∞–∑–Ω–∞—á–∏—Ç—å –æ—Ç–¥–µ–ª",
"employee_change_department": "üîÑ –°–º–µ–Ω–∏—Ç—å –æ—Ç–¥–µ–ª",
"employee_select_department": "–í—ã–±–µ—Ä–∏—Ç–µ –æ—Ç–¥–µ–ª –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è {name}:",
"employee_department_assigned": "‚úÖ –û—Ç–¥–µ–ª —É—Å–ø–µ—à–Ω–æ –Ω–∞–∑–Ω–∞—á–µ–Ω!",
"employee_department_error": "‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏–∏ –æ—Ç–¥–µ–ª–∞.",
"employee_notification_title": "üì¢ –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ",
"employee_notification_assigned": "–í–∞–º –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω –¥–æ—Å—Ç—É–ø –∫ –æ—Ç–¥–µ–ª—É: {department}",
"employee_back_to_list": "‚¨ÖÔ∏è –ö —Å–ø–∏—Å–∫—É —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤"
```

---

## 8. –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–∞:
–í—Å–µ —Ö–µ–Ω–¥–ª–µ—Ä—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞–º–∏ –∑–∞—â–∏—â–µ–Ω—ã —Ñ—É–Ω–∫—Ü–∏–µ–π `check_admin_access(user_id)`:

```python
if not await check_admin_access(message.from_user.id):
    await message.answer(i18n.get("admin_no_access", lang))
    return
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤ callback-—Ö–µ–Ω–¥–ª–µ—Ä–∞—Ö:
```python
if not await check_admin_access(callback.from_user.id):
    await callback.answer(i18n.get("admin_no_access_short", lang), show_alert=True)
    return
```

### –ó–∞—â–∏—Ç–∞ –æ—Ç BUTTON_DATA_INVALID:
- Callback data –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Ç–æ–ª—å–∫–æ `telegram_id` (—á–∏—Å–ª–æ–≤–æ–π —Ñ–æ—Ä–º–∞—Ç)
- –ü—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –º–æ–∂–Ω–æ –ø–µ—Ä–µ–∫–ª—é—á–∏—Ç—å—Å—è –Ω–∞ —Ö–µ—à-–ø–æ–¥—Ö–æ–¥ —á–µ—Ä–µ–∑ `hash_user_id()`

---

## 9. –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### 9.1. –°—Ç—Ä—É–∫—Ç—É—Ä–∞ callback_data:

| Callback | –§–æ—Ä–º–∞—Ç | –û–ø–∏—Å–∞–Ω–∏–µ |
|----------|--------|----------|
| –°–ø–∏—Å–æ–∫ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ | `emp_view:{telegram_id}` | –ü–æ–∫–∞–∑–∞—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–µ |
| –ù–∞–∑–∞–¥ –∫ —Å–ø–∏—Å–∫—É | `emp_list` | –í–µ—Ä–Ω—É—Ç—å—Å—è –∫ —Å–ø–∏—Å–∫—É –≤—Å–µ—Ö —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ |
| –ù–∞–∑–Ω–∞—á–∏—Ç—å –æ—Ç–¥–µ–ª | `emp_assign:{telegram_id}` | –ü–æ–∫–∞–∑–∞—Ç—å —Å–ø–∏—Å–æ–∫ –æ—Ç–¥–µ–ª–æ–≤ –¥–ª—è –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è |
| –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –æ—Ç–¥–µ–ª | `emp_set:{telegram_id}:{dept}` | –ù–∞–∑–Ω–∞—á–∏—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π –æ—Ç–¥–µ–ª |

### 9.2. –û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã:

```
app/core/models.py                  # –î–æ–±–∞–≤–ª–µ–Ω Department.COMMON + –Ω–æ–≤—ã–µ –º–µ—Ç–æ–¥—ã
app/bot/handlers/start.py           # Auto-registration —Å department="common"
app/services/ai_service.py          # RAG –ø–æ–∏—Å–∫: —Å–≤–æ–π –æ—Ç–¥–µ–ª + common
app/bot/handlers/admin.py           # –ù–æ–≤–∞—è –∫–Ω–æ–ø–∫–∞ + —Ö–µ–Ω–¥–ª–µ—Ä—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞–º–∏
app/services/employee_service.py    # –ù–æ–≤—ã–π —Å–µ—Ä–≤–∏—Å –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞–º–∏
app/core/locales/ru.json            # –õ–æ–∫–∞–ª–∏–∑–∞—Ü–∏—è (—Ä—É—Å—Å–∫–∏–π)
app/core/locales/en.json            # –õ–æ–∫–∞–ª–∏–∑–∞—Ü–∏—è (–∞–Ω–≥–ª–∏–π—Å–∫–∏–π)
app/core/locales/kk.json            # –õ–æ–∫–∞–ª–∏–∑–∞—Ü–∏—è (–∫–∞–∑–∞—Ö—Å–∫–∏–π)
app/core/locales/zh.json            # –õ–æ–∫–∞–ª–∏–∑–∞—Ü–∏—è (–∫–∏—Ç–∞–π—Å–∫–∏–π)
```

---

## 10. –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### 10.1. –°—Ü–µ–Ω–∞—Ä–∏–π 1: –ù–æ–≤—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å (–Ω–µ –∞–¥–º–∏–Ω)

1. **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç `/start`**
   - –°–æ–∑–¥–∞–µ—Ç—Å—è –≤ –ë–î: `role="employee"`, `department="common"`
   - –í–∏–¥–∏—Ç —Ç–æ–ª—å–∫–æ —Ñ–∞–π–ª—ã –∏–∑ –ø–∞–ø–∫–∏ `data/knowledge/common/`

2. **–ê–¥–º–∏–Ω –Ω–∞–∑–Ω–∞—á–∞–µ—Ç –æ—Ç–¥–µ–ª "–°–æ—Ä—Ç–∏—Ä–æ–≤–æ—á–Ω—ã–π —Ü–µ–Ω—Ç—Ä"**
   - `department` –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è —Å `"common"` ‚Üí `"sorting"`
   - –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–æ–ª—É—á–∞–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ:
     ```
     üì¢ –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
     
     –í–∞–º –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω –¥–æ—Å—Ç—É–ø –∫ –æ—Ç–¥–µ–ª—É: –°–æ—Ä—Ç–∏—Ä–æ–≤–æ—á–Ω—ã–π —Ü–µ–Ω—Ç—Ä
     ```

3. **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞–¥–∞–µ—Ç –≤–æ–ø—Ä–æ—Å**
   - RAG –∏—â–µ—Ç –≤ `data/knowledge/sorting/` + `data/knowledge/common/`
   - –ü–æ–ª—É—á–∞–µ—Ç –æ—Ç–≤–µ—Ç –Ω–∞ –æ—Å–Ω–æ–≤–µ –æ–±–æ–∏—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤

### 10.2. –°—Ü–µ–Ω–∞—Ä–∏–π 2: –ê–¥–º–∏–Ω (God Mode)

1. **–ê–¥–º–∏–Ω –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç `/start`**
   - –°–æ–∑–¥–∞–µ—Ç—Å—è –≤ –ë–î: `role="admin"`, `department=None`
   - –í–∏–¥–∏—Ç –í–°–ï —Ñ–∞–π–ª—ã –∏–∑ –≤—Å–µ—Ö –æ—Ç–¥–µ–ª–æ–≤

2. **–ê–¥–º–∏–Ω –∑–∞–¥–∞–µ—Ç –≤–æ–ø—Ä–æ—Å**
   - RAG –∏—â–µ—Ç –ø–æ –í–°–ï–ú –∏–Ω–¥–µ–∫—Å–∞–º: sorting, manager, courier, franchise, customer_service, common
   - –û—Ç–≤–µ—Ç —Å–æ–¥–µ—Ä–∂–∏—Ç –º–µ—Ç–∫–∏ –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤: `[–ò—Å—Ç–æ—á–Ω–∏–∫: sorting]`, `[–ò—Å—Ç–æ—á–Ω–∏–∫: –û–±—â–∏–µ –∑–Ω–∞–Ω–∏—è]`

### 10.3. –°—Ü–µ–Ω–∞—Ä–∏–π 3: –°–º–µ–Ω–∞ –æ—Ç–¥–µ–ª–∞

1. **–ê–¥–º–∏–Ω –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç —Ä–∞–∑–¥–µ–ª "üë• –°–æ—Ç—Ä—É–¥–Ω–∏–∫–∏"**
2. **–í—ã–±–∏—Ä–∞–µ—Ç —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞ –∏–∑ —Å–ø–∏—Å–∫–∞**
3. **–ù–∞–∂–∏–º–∞–µ—Ç "üîÑ –°–º–µ–Ω–∏—Ç—å –æ—Ç–¥–µ–ª"**
4. **–í—ã–±–∏—Ä–∞–µ—Ç –Ω–æ–≤—ã–π –æ—Ç–¥–µ–ª (–Ω–∞–ø—Ä–∏–º–µ—Ä, "–ú–µ–Ω–µ–¥–∂–µ—Ä")**
5. **–°–∏—Å—Ç–µ–º–∞**:
   - –û–±–Ω–æ–≤–ª—è–µ—Ç `department` –≤ –ë–î
   - –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
   - –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–µ

---

## 11. –õ–æ–≥–∏ –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ `employee_service.py`:
```
[EMPLOYEES] Found 15 registered users
[EMPLOYEES] Found user: 123456789 (–ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤)
[EMPLOYEES] COMMIT executed for user 123456789
[EMPLOYEES] ‚úÖ Department assigned to 123456789 (–ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤): sorting (was: common)
```

### –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ `admin.py`:
```
Admin 987654321 viewed employee list (15 users)
Admin 987654321 viewed employee 123456789 details
Admin 987654321 selecting department for employee 123456789
Notification sent to user 123456789 about department assignment
Admin 987654321 assigned department 'sorting' to employee 123456789
```

### –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ `ai_service.py` (RAG):
```
[RAG] User 123456789 department: sorting
[RAG] User 123456789 (Dept: sorting) searching in department index...
[RAG] Also searching in 'common' for user 123456789...
[RAG] Found 3 chunks (from sorting + common)
```

---

## 12. –ò–∑–≤–µ—Å—Ç–Ω—ã–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –∏ –±—É–¥—É—â–∏–µ —É–ª—É—á—à–µ–Ω–∏—è

### –¢–µ–∫—É—â–∏–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è:
1. **COMMON –Ω–µ–ª—å–∑—è –Ω–∞–∑–Ω–∞—á–∏—Ç—å –≤—Ä—É—á–Ω—É—é** ‚Äî —ç—Ç–æ –¥–µ—Ñ–æ–ª—Ç–Ω—ã–π —Å—Ç–∞—Ç—É—Å –ø—Ä–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏
2. **–•–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ ID –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è** ‚Äî callback_data –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –ø–æ–ª–Ω—ã–π telegram_id (–ø—Ä–∏ –±–æ–ª—å—à–∏—Ö ID –º–æ–∂–µ—Ç –ø–æ—Ç—Ä–µ–±–æ–≤–∞—Ç—å—Å—è –ø–µ—Ä–µ—Ö–æ–¥ –Ω–∞ —Ö–µ—à)
3. **–ù–µ—Ç –∏—Å—Ç–æ—Ä–∏–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–π –æ—Ç–¥–µ–ª–æ–≤** ‚Äî –Ω–µ –ª–æ–≥–∏—Ä—É–µ—Ç—Å—è –∫—Ç–æ –∏ –∫–æ–≥–¥–∞ –º–µ–Ω—è–ª –æ—Ç–¥–µ–ª (–º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å —Ç–∞–±–ª–∏—Ü—É `department_history`)

### –ë—É–¥—É—â–∏–µ —É–ª—É—á—à–µ–Ω–∏—è:
1. **–ü–∞–∫–µ—Ç–Ω–æ–µ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ –æ—Ç–¥–µ–ª–æ–≤** ‚Äî –≤—ã–±—Ä–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ –∏ –Ω–∞–∑–Ω–∞—á–∏—Ç—å –æ—Ç–¥–µ–ª –æ–¥–Ω–æ–π –∫–Ω–æ–ø–∫–æ–π
2. **–≠–∫—Å–ø–æ—Ä—Ç —Å–ø–∏—Å–∫–∞ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤** ‚Äî —Å–∫–∞—á–∞—Ç—å CSV/Excel —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è—Ö
3. **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –æ—Ç–¥–µ–ª–∞–º** ‚Äî —Å–∫–æ–ª—å–∫–æ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ –≤ –∫–∞–∂–¥–æ–º –æ—Ç–¥–µ–ª–µ
4. **–§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –∏ –ø–æ–∏—Å–∫** ‚Äî –Ω–∞–π—Ç–∏ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞ –ø–æ –∏–º–µ–Ω–∏ –∏–ª–∏ Telegram ID
5. **–†–æ–ª–∏ —Å –∫–∞—Å—Ç–æ–º–Ω—ã–º–∏ –ø—Ä–∞–≤–∞–º–∏** ‚Äî –Ω–µ —Ç–æ–ª—å–∫–æ admin/employee, –Ω–æ –∏ manager —Å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–º–∏ –ø—Ä–∞–≤–∞–º–∏

---

## 13. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Å–ª–µ –¥–µ–ø–ª–æ—è:

1. **–°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–Ω–µ –∞–¥–º–∏–Ω–∞)**:
   ```
   /start ‚Üí –í—ã–±–æ—Ä —è–∑—ã–∫–∞ ‚Üí –ò–Ω–≤–∞–π—Ç-–∫–æ–¥ ‚Üí –í—ã–±–æ—Ä –æ—Ç–¥–µ–ª–∞
   ```
   - –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ —Å–æ–∑–¥–∞–ª—Å—è —Å `department="common"`

2. **–ó–∞–π–¥–∏—Ç–µ –∫–∞–∫ –∞–¥–º–∏–Ω**:
   ```
   üë• –°–æ—Ç—Ä—É–¥–Ω–∏–∫–∏ ‚Üí –í—ã–±–µ—Ä–∏—Ç–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è ‚Üí üîÑ –°–º–µ–Ω–∏—Ç—å –æ—Ç–¥–µ–ª ‚Üí –í—ã–±–µ—Ä–∏—Ç–µ "–°–æ—Ä—Ç–∏—Ä–æ–≤–æ—á–Ω—ã–π —Ü–µ–Ω—Ç—Ä"
   ```
   - –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–æ–ª—É—á–∏–ª —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
   - –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ –≤ –ë–î `department` –æ–±–Ω–æ–≤–∏–ª—Å—è

3. **–ó–∞–¥–∞–π—Ç–µ –≤–æ–ø—Ä–æ—Å –∫–∞–∫ –æ–±—ã—á–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å**:
   - –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤ –ª–æ–≥–∞—Ö: `[RAG] User X (Dept: sorting) searching in department index...`
   - –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ –ø–æ–∏—Å–∫ –∏–¥–µ—Ç –≤ `sorting + common`

4. **–ó–∞–¥–∞–π—Ç–µ –≤–æ–ø—Ä–æ—Å –∫–∞–∫ –∞–¥–º–∏–Ω**:
   - –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤ –ª–æ–≥–∞—Ö: `[RAG] üî• ADMIN GOD MODE: Searching across ALL department indices...`
   - –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ –≤ –æ—Ç–≤–µ—Ç–µ –µ—Å—Ç—å –º–µ—Ç–∫–∏ –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤

---

## 14. Git –∫–æ–º–∞–Ω–¥—ã –¥–ª—è –¥–µ–ø–ª–æ—è

```powershell
# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞
git status

# –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ñ–∞–π–ª–æ–≤
git add app/core/models.py app/bot/handlers/start.py app/services/ai_service.py app/bot/handlers/admin.py app/services/employee_service.py app/core/locales/*.json ROLES_AND_DEPARTMENTS_SYSTEM.md

# –ö–æ–º–º–∏—Ç
git commit -m "feat: Implement role-based access and department management system

- Added Department.COMMON for default access
- Auto-registration with department='common' for new employees
- RAG search: user's department + common (God Mode for admins)
- Admin panel: Employee management with department assignment
- User notifications when department is assigned
- Full i18n support (ru, en, kk, zh)
- New service: employee_service.py for employee operations
- Security: All handlers protected with check_admin_access()"

# Push
git push origin main
```

---

## 15. –ö–æ–Ω—Ç–∞–∫—Ç—ã –∏ –ø–æ–¥–¥–µ—Ä–∂–∫–∞

**–†–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫**: UQsoft Development Team
**–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è**: 13 —Ñ–µ–≤—Ä–∞–ª—è 2026
**–í–µ—Ä—Å–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–∞**: 1.0

**–§–∞–π–ª—ã –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏**:
- `ROLES_AND_DEPARTMENTS_SYSTEM.md` ‚Äî –≠—Ç–æ—Ç —Ñ–∞–π–ª
- `README.md` ‚Äî –û–±—â–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø—Ä–æ–µ–∫—Ç–µ
- `CRITICAL_FIX_USER_REGISTRATION.md` ‚Äî –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

---

üöÄ **–°–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞ –∫ —Ä–∞–±–æ—Ç–µ! –í—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω—ã –∏ –≥–æ—Ç–æ–≤—ã –∫ –¥–µ–ø–ª–æ—é.**

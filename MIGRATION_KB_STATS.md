# –ú–∏–≥—Ä–∞—Ü–∏—è: –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –±–∞–∑—ã –∑–Ω–∞–Ω–∏–π –ø–æ –æ—Ç–¥–µ–ª–∞–º –≤ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏

## –û–ø–∏—Å–∞–Ω–∏–µ –∑–∞–¥–∞—á–∏
–¢–µ–ø–µ—Ä—å –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –¥–µ—Ç–∞–ª—å–Ω—É—é —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –ø–æ –±–∞–∑–µ –∑–Ω–∞–Ω–∏–π —Å —Ä–∞–∑–±–∏–≤–∫–æ–π –ø–æ –æ—Ç–¥–µ–ª–∞–º –≤–º–µ—Å—Ç–æ —Å–æ–æ–±—â–µ–Ω–∏—è "–ë–∞–∑–∞ –ø—É—Å—Ç–∞".

## –ß—Ç–æ –∏–∑–º–µ–Ω–µ–Ω–æ

### 1. –ù–æ–≤—ã–π –º–µ—Ç–æ–¥ –≤ `app/services/ai_service.py`

**–ú–µ—Ç–æ–¥:** `GeminiService.get_knowledge_stats() -> dict[str, int]`

–°–æ–±–∏—Ä–∞–µ—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –ø–æ –±–∞–∑–µ –∑–Ω–∞–Ω–∏–π:
- –°–∫–∞–Ω–∏—Ä—É–µ—Ç –ø–∞–ø–∫—É `data/knowledge/`
- –°—á–∏—Ç–∞–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ñ–∞–π–ª–æ–≤ (.txt, .pdf, .docx, .md, .rst) –≤ –∫–∞–∂–¥–æ–º –æ—Ç–¥–µ–ª–µ
- –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –≤–ª–æ–∂–µ–Ω–Ω—ã–µ –ø–∞–ø–∫–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, `delivery/courier`, `delivery/franchise`)
- –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–ª–æ–≤–∞—Ä—å `{department_name: file_count}`

**–ü—Ä–∏–º–µ—Ä –≤—ã–≤–æ–¥–∞:**
```python
{
    "common": 3,
    "customer_service": 1,
    "delivery": 3,  # –≤–∫–ª—é—á–∞–µ—Ç courier + franchise
    "manager": 2,
    "sorting": 3
}
```

### 2. –û–±–Ω–æ–≤–ª—ë–Ω —Ö–µ–Ω–¥–ª–µ—Ä –≤ `app/bot/handlers/admin.py`

**–§—É–Ω–∫—Ü–∏—è:** `handle_manage_knowledge()`

**–ò–∑–º–µ–Ω–µ–Ω–∏—è:**
- –í—ã–∑—ã–≤–∞–µ—Ç `GeminiService.get_knowledge_stats()` –≤–º–µ—Å—Ç–æ `get_knowledge_files()`
- –§–æ—Ä–º–∞—Ç–∏—Ä—É–µ—Ç –≤—ã–≤–æ–¥ —Å –ª–æ–∫–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–º–∏ –Ω–∞–∑–≤–∞–Ω–∏—è–º–∏ –æ—Ç–¥–µ–ª–æ–≤
- –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∏—Ç–æ–≥–æ–≤–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
- –ï—Å–ª–∏ –±–∞–∑–∞ –ø—É—Å—Ç–∞, –≤—ã–≤–æ–¥–∏—Ç –ª–æ–∫–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ —Å –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–µ–π

**–§–æ—Ä–º–∞—Ç —Å–æ–æ–±—â–µ–Ω–∏—è:**
```
üì¶ –ë–∞–∑–∞ –∑–Ω–∞–Ω–∏–π –ø–æ –æ—Ç–¥–µ–ª–∞–º:

‚Ä¢ –û–±—â–∏–µ –∑–Ω–∞–Ω–∏—è: 3 –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
‚Ä¢ –î–æ—Å—Ç–∞–≤–∫–∞: 3 –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
‚Ä¢ –ö–ª–∏–µ–Ω—Ç—Å–∫–∏–π —Å–µ—Ä–≤–∏—Å: 1 –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
‚Ä¢ –ú–µ–Ω–µ–¥–∂–µ—Ä: 2 –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
‚Ä¢ –°–æ—Ä—Ç–∏—Ä–æ–≤–æ—á–Ω—ã–π —Ü–µ–Ω—Ç—Ä: 3 –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤

üìä –í—Å–µ–≥–æ: 12 –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
```

### 3. –õ–æ–∫–∞–ª–∏–∑–∞—Ü–∏—è

–î–æ–±–∞–≤–ª–µ–Ω—ã –∫–ª—é—á–∏ –≤–æ –≤—Å–µ —è–∑—ã–∫–æ–≤—ã–µ —Ñ–∞–π–ª—ã (`app/core/locales/*.json`):

| –ö–ª—é—á | RU | EN | KK | ZH |
|------|----|----|----|----|
| `kb_stats_header` | "üì¶ –ë–∞–∑–∞ –∑–Ω–∞–Ω–∏–π –ø–æ –æ—Ç–¥–µ–ª–∞–º:" | "üì¶ Knowledge Base by Departments:" | "üì¶ –ë”©–ª—ñ–º–¥–µ—Ä –±–æ–π—ã–Ω—à–∞ –±—ñ–ª—ñ–º –±–∞–∑–∞—Å—ã:" | "üì¶ ÊåâÈÉ®Èó®ÂàÜÁ±ªÁöÑÁü•ËØÜÂ∫ìÔºö" |
| `kb_empty` | "‚ùå –ë–∞–∑–∞ –∑–Ω–∞–Ω–∏–π –ø–æ–∫–∞ –ø—É—Å—Ç–∞..." | "‚ùå Knowledge base is empty..." | "‚ùå –ë—ñ–ª—ñ–º –±–∞–∑–∞—Å—ã ”ô–∑—ñ—Ä—à–µ –±–æ—Å..." | "‚ùå Áü•ËØÜÂ∫ìÁõÆÂâç‰∏∫Á©∫..." |
| `kb_dept_common` | "–û–±—â–∏–µ –∑–Ω–∞–Ω–∏—è" | "Common Knowledge" | "–ñ–∞–ª–ø—ã –±—ñ–ª—ñ–º" | "ÈÄöÁî®Áü•ËØÜ" |
| `kb_documents` | "–¥–æ–∫—É–º–µ–Ω—Ç–æ–≤" | "documents" | "“õ“±–∂–∞—Ç" | "ÊñáÊ°£" |
| `kb_total` | "–í—Å–µ–≥–æ" | "Total" | "–ë–∞—Ä–ª—ã“ì—ã" | "ÊÄªËÆ°" |

### 4. –ú–∞–ø–ø–∏–Ω–≥ –æ—Ç–¥–µ–ª–æ–≤

–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Å—É—â–µ—Å—Ç–≤—É—é—â–∞—è –ª–æ–∫–∞–ª–∏–∑–∞—Ü–∏—è –¥–ª—è –Ω–∞–∑–≤–∞–Ω–∏–π –æ—Ç–¥–µ–ª–æ–≤:
- `department_delivery` ‚Üí "–î–æ—Å—Ç–∞–≤–∫–∞" / "Delivery" / "–ñ–µ—Ç–∫—ñ–∑—É" / "ÈÖçÈÄÅ"
- `department_sorting` ‚Üí "–°–æ—Ä—Ç–∏—Ä–æ–≤–æ—á–Ω—ã–π —Ü–µ–Ω—Ç—Ä" / "Sorting Center" / ...
- `department_manager` ‚Üí "–ú–µ–Ω–µ–¥–∂–µ—Ä" / "Manager" / ...
- `department_customer_service` ‚Üí "–ö–ª–∏–µ–Ω—Ç—Å–∫–∏–π —Å–µ—Ä–≤–∏—Å" / "Customer Service" / ...

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

```python
from app.services.ai_service import GeminiService

# –ü–æ–ª—É—á–∏—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
stats = GeminiService.get_knowledge_stats()
print(stats)
# –í—ã–≤–æ–¥: {'common': 3, 'customer_service': 1, 'delivery': 3, 'manager': 2, 'sorting': 3}
```

## –ü—Ä–∏–º–µ—á–∞–Ω–∏—è

- –ú–µ—Ç–æ–¥ —Ä–µ–∫—É—Ä—Å–∏–≤–Ω–æ —Å–∫–∞–Ω–∏—Ä—É–µ—Ç –ø–æ–¥–ø–∞–ø–∫–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, `delivery/courier/` —Å—á–∏—Ç–∞–µ—Ç—Å—è –∫–∞–∫ —á–∞—Å—Ç—å `delivery`)
- –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è —Ñ–æ—Ä–º–∞—Ç—ã: `.txt`, `.pdf`, `.docx`, `.md`, `.rst`
- –ü—Ä–∏ –æ—à–∏–±–∫–µ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –ø—É—Å—Ç–æ–π —Å–ª–æ–≤–∞—Ä—å `{}`
- –ï—Å–ª–∏ –≤ –æ—Ç–¥–µ–ª–µ –Ω–µ—Ç —Ñ–∞–π–ª–æ–≤, –æ–Ω –Ω–µ –ø–æ–ø–∞–¥–∞–µ—Ç –≤ —Ä–µ–∑—É–ª—å—Ç–∞—Ç

## –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å

- ‚úÖ –û–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞
- ‚úÖ –ú–µ—Ç–æ–¥ `get_knowledge_files()` –ø–æ-–ø—Ä–µ–∂–Ω–µ–º—É —Ä–∞–±–æ—Ç–∞–µ—Ç (–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª—Å—è –¥–ª—è —Å—Ç–∞—Ä–æ–π –ª–æ–≥–∏–∫–∏ —É–¥–∞–ª–µ–Ω–∏—è —Ñ–∞–π–ª–æ–≤)
- ‚úÖ –í—Å–µ —è–∑—ã–∫–æ–≤—ã–µ –≤–µ—Ä—Å–∏–∏ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è

## –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≤ –±–æ—Ç–µ

–ê–¥–º–∏–Ω –Ω–∞–∂–∏–º–∞–µ—Ç "üìö –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –±–∞–∑–æ–π –∑–Ω–∞–Ω–∏–π" ‚Üí –≤–∏–¥–∏—Ç:

**–†—É—Å—Å–∫–∏–π:**
```
üì¶ –ë–∞–∑–∞ –∑–Ω–∞–Ω–∏–π –ø–æ –æ—Ç–¥–µ–ª–∞–º:

‚Ä¢ –û–±—â–∏–µ –∑–Ω–∞–Ω–∏—è: 3 –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
‚Ä¢ –î–æ—Å—Ç–∞–≤–∫–∞: 3 –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
‚Ä¢ –°–æ—Ä—Ç–∏—Ä–æ–≤–æ—á–Ω—ã–π —Ü–µ–Ω—Ç—Ä: 3 –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
‚Ä¢ –ú–µ–Ω–µ–¥–∂–µ—Ä: 2 –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
‚Ä¢ –ö–ª–∏–µ–Ω—Ç—Å–∫–∏–π —Å–µ—Ä–≤–∏—Å: 1 –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤

üìä –í—Å–µ–≥–æ: 12 –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
```

**English:**
```
üì¶ Knowledge Base by Departments:

‚Ä¢ Common Knowledge: 3 documents
‚Ä¢ Delivery: 3 documents
‚Ä¢ Sorting Center: 3 documents
‚Ä¢ Manager: 2 documents
‚Ä¢ Customer Service: 1 documents

üìä Total: 12 documents
```

## –°–≤—è–∑–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

- `app/services/ai_service.py` ‚Äî –º–µ—Ç–æ–¥ `get_knowledge_stats()`
- `app/bot/handlers/admin.py` ‚Äî —Ö–µ–Ω–¥–ª–µ—Ä `handle_manage_knowledge()`
- `app/core/locales/*.json` ‚Äî –ª–æ–∫–∞–ª–∏–∑–∞—Ü–∏—è (ru, en, kk, zh)
